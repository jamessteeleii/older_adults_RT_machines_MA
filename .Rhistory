?posterior_draws
avg_predictions()
?avg_predictions()
meta_function <- brm(yi | se(sqrt(vi)) ~ training_control +
(training_control | study_code) +
(1 | group_code) +
(1 | es_code),
data = data_function,
chains = 4,
cores = 4,
seed = 1988,
warmup = 2000,
iter = 6000,
control = list(adapt_delta = 0.99, max_treedepth = 11)
)
plot(meta_function)
pp_check(meta_function)
meta_pred <- predictions(
meta_function,
re_formula = NA
) |>
posterior_draws()
meta_pred_labels <- meta_pred |>
group_by(training_control) |>
mean_qi(draw)
study_pred <- predictions(
meta_function,
re_formula = NULL,
) |>
posterior_draws()
study_labels <- data_function |>
select(1,2) |>
group_by(study_code) |>
slice(1)
study_pred <- left_join(study_pred, study_labels, by = "study_code") |>
group_by(study) |>
mutate(mean_draw = mean(draw))
study_pred_labels <- study_pred |>
group_by(study, training_control) |>
mean_qi(draw)
meta_slopes <- avg_slopes(
meta_function,
re_formula = NA,
variables = "training_control"
) |>
posterior_draws()
meta_slopes_labels <- meta_slopes |>
group_by(contrast) |>
mean_qi(draw)
meta_pred_plot <- ggplot(meta_pred, aes(x = draw, fill = training_control)) +
geom_vline(xintercept = 0, lty = "dashed") +
stat_halfeye(slab_alpha = .5, .width = 0.95) +
facet_grid(training_control~.) +
scale_fill_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
geom_text(
data = mutate_if(meta_pred_labels,
is.numeric, round, 2),
aes(
label = glue::glue("{draw} [{.lower}, {.upper}]"),
x = draw, y = 0.1
),
size = 3
) +
labs(
x = "Standardised Mean Change",
fill = "Condition",
title = "Global Grand Mean Estimates for Condition"
) +
theme_bw() +
theme(axis.text.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
theme(title = element_text(size=8))
study_pred_plot <- ggplot(study_pred, aes(x = draw,
y = reorder(study, mean_draw),
fill = training_control)) +
geom_vline(xintercept = 0, lty = "dashed") +
# Add individual study data
geom_point(
data = data_function,
aes(x = yi, y = study, color = training_control),
position = position_jitterdodge(dodge.width = 0.5, jitter.width = 0.1),
alpha = 0.5
) +
stat_halfeye(slab_alpha = .5, position = position_dodge(width = 0.5), size = 0.25) +
scale_fill_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
geom_text(
data = mutate_if(study_pred_labels,
is.numeric, round, 2),
aes(
label = glue::glue("{training_control}: {draw} [{.lower}, {.upper}]"),
x = 3, y =reorder(study, draw), group = training_control
),
size = 2, position = position_dodge(width = 0.75),
hjust = "inward"
) +
labs(
x = "Standardised Mean Change",
title = "Conditional Estimates for Condition by Study"
) +
guides(
fill = "none",
color = "none"
) +
theme_bw() +
theme(axis.title.y = element_blank()) +
theme(title = element_text(size=8))
contrast_plot <- ggplot(meta_slopes, aes(x = draw)) +
geom_vline(xintercept = 0, lty = "dashed") +
stat_halfeye(slab_alpha = .5, fill = "black") +
geom_text(
data = mutate_if(meta_slopes_labels,
is.numeric, round, 2),
aes(
label = glue::glue("{draw} [{.lower}, {.upper}]"),
x = draw, y = 0.1
),
size = 3
) +
labs(
x = "Standardised Mean Change",
title = "Contrasts Between Conditions (Training - Control)"
) +
theme_bw() +
theme(axis.text.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
theme(title = element_text(size=8))
meta_plots <- (study_pred_plot / (meta_pred_plot + contrast_plot)) +
plot_annotation(title = "Meta-Analysis of Prior Studies Examining the Effects of Machine Based Resistance Training on Function",
caption = "Point estimates and 95% quantile intervals reported") +
plot_layout(guides = "collect", axis_titles = "collect",
widths = c(2,1,1))  &
theme(axis.title.x = element_text(size=10),
legend.position = "bottom")
meta_plots
ggsave("meta_plots_function.tiff", dpi = 300, w=10, h=10)
meta_strength <- brm(yi | se(sqrt(vi)) ~ training_control +
(training_control | study_code) +
(1 | group_code) +
(1 | es_code),
data = data_strength,
chains = 4,
cores = 4,
seed = 1988,
warmup = 2000,
iter = 6000,
control = list(adapt_delta = 0.99, max_treedepth = 11)
)
plot(meta_strength)
pp_check(meta_strength)
meta_pred <- predictions(
meta_strength,
re_formula = NA
) |>
posterior_draws()
meta_pred_labels <- meta_pred |>
group_by(training_control) |>
mean_qi(draw)
study_pred <- predictions(
meta_strength,
re_formula = NULL,
) |>
posterior_draws()
study_labels <- data_strength |>
select(1,2) |>
group_by(study_code) |>
slice(1)
study_pred <- left_join(study_pred, study_labels, by = "study_code") |>
group_by(study) |>
mutate(mean_draw = mean(draw))
study_pred_labels <- study_pred |>
group_by(study, training_control) |>
mean_qi(draw)
meta_slopes <- avg_slopes(
meta_strength,
re_formula = NA,
variables = "training_control"
) |>
posterior_draws()
meta_slopes_labels <- meta_slopes |>
group_by(contrast) |>
mean_qi(draw)
meta_pred_plot <- ggplot(meta_pred, aes(x = draw, fill = training_control)) +
geom_vline(xintercept = 0, lty = "dashed") +
stat_halfeye(slab_alpha = .5, .width = 0.95) +
facet_grid(training_control~.) +
scale_fill_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
geom_text(
data = mutate_if(meta_pred_labels,
is.numeric, round, 2),
aes(
label = glue::glue("{draw} [{.lower}, {.upper}]"),
x = draw, y = 0.1
),
size = 3
) +
labs(
x = "Standardised Mean Change",
fill = "Condition",
title = "Global Grand Mean Estimates for Condition"
) +
theme_bw() +
theme(axis.text.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
theme(title = element_text(size=8))
study_pred_plot <- ggplot(study_pred, aes(x = draw,
y = reorder(study, mean_draw),
fill = training_control)) +
geom_vline(xintercept = 0, lty = "dashed") +
# Add individual study data
geom_point(
data = data_strength,
aes(x = yi, y = study, color = training_control),
position = position_jitterdodge(dodge.width = 0.5, jitter.width = 0.1),
alpha = 0.5
) +
stat_halfeye(slab_alpha = .5, position = position_dodge(width = 0.5), size = 0.25) +
scale_fill_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
geom_text(
data = mutate_if(study_pred_labels,
is.numeric, round, 2),
aes(
label = glue::glue("{training_control}: {draw} [{.lower}, {.upper}]"),
x = 3, y =reorder(study, draw), group = training_control
),
size = 2, position = position_dodge(width = 0.75),
hjust = "inward"
) +
labs(
x = "Standardised Mean Change",
title = "Conditional Estimates for Condition by Study"
) +
guides(
fill = "none",
color = "none"
) +
theme_bw() +
theme(axis.title.y = element_blank()) +
theme(title = element_text(size=8))
contrast_plot <- ggplot(meta_slopes, aes(x = draw)) +
geom_vline(xintercept = 0, lty = "dashed") +
stat_halfeye(slab_alpha = .5, fill = "black") +
geom_text(
data = mutate_if(meta_slopes_labels,
is.numeric, round, 2),
aes(
label = glue::glue("{draw} [{.lower}, {.upper}]"),
x = draw, y = 0.1
),
size = 3
) +
labs(
x = "Standardised Mean Change",
title = "Contrasts Between Conditions (Training - Control)"
) +
theme_bw() +
theme(axis.text.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
theme(title = element_text(size=8))
meta_plots <- (study_pred_plot / (meta_pred_plot + contrast_plot)) +
plot_annotation(title = "Meta-Analysis of Prior Studies Examining the Effects of Machine Based Resistance Training on Strength",
caption = "Point estimates and 95% quantile intervals reported") +
plot_layout(guides = "collect", axis_titles = "collect",
widths = c(2,1,1))  &
theme(axis.title.x = element_text(size=10),
legend.position = "bottom")
meta_plots
ggsave("meta_plots_strength.tiff", dpi = 300, w=10, h=10)
install.packages("broom.mixed")
targets::tar_visnetwork()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
install.packages("quarto")
targets::tar_make()
install.packages("bayesplot")
targets::tar_make()
targets::tar_load(model_strength)
model_strength
targets::tar_make()
targets::tar_visnetwork()
targets::tar_load(model_function)
model_function
model_function$data2
View(model_function)
View(model_strength)
length(unique(model_function$data$study_code))
`r length(unique(model_function$data$group_code))`
length(unique(model_function$data$group_code))
model_function$data$
model_function$data
model_function$data
model_function$data |> group_by(group_code) |> count(training_control)
library(tidyverse)
model_function$data |> group_by(group_code) |> count(training_control)
model_function$data |> group_by(group_code) |> slice_head() |> count(training_control)
model_function$data |> count(training_control)
model_function$data |> group_by(study_code) |> count(training_control)
model_function$data |> group_by(study_code) |> slice_head() |> ungroup |> count(training_control)
model_function$data |> group_by(study_code) |> slice_head() |> ungroup() |> count(training_control)
model_function$data |> group_by(study_code, training_control) |> slice_head() |> ungroup() |> count(training_control)
model_strength$data |> group_by(study_code, training_control) |> slice_head() |> ungroup() |> count(training_control)
model_function$data |> group_by(study_code, training_control) |> slice_head() |> ungroup() |> count(training_control)[2,1]
model_function$data |> group_by(study_code, training_control) |> slice_head() |> ungroup() |> count(training_control) |> [2,1]
n_conditions_function <- model_function$data |> group_by(study_code, training_control) |> slice_head() |> ungroup() |> count(training_control)
n_conditions_strength <- model_strength$data |> group_by(study_code, training_control) |> slice_head() |> ungroup() |> count(training_control)
n_conditions_function[2,1]
n_conditions_function[1,1]
n_conditions_function[1,2]
targets::tar_load(
model_function,
tidy_model_function,
combined_function_plot,
model_strength,
tidy_model_strength,
combined_strength_plot
)
targets::tar_load(combined_function_plot)
targets::tar_load(
model_function,
tidy_model_function,
combined_function_plot,
model_strength,
tidy_model_strength,
combined_strength_plot
)
targets::tar_load(
model_function,
tidy_model_function,
combined_function_plot,
model_strength,
tidy_model_strength,
combined_strength_plot
)
targets::tar_load(combined_strength_plot)
targets::tar_load(
model_function,
tidy_model_function,
combined_function_plot,
model_strength,
tidy_model_strength,
combined_strength_plot
)
targets::tar_load(tidy_model_function)
targets::tar_load(tidy_model_strength)
targets::tar_load(
model_function,
tidy_model_function,
combined_function_plot,
model_strength,
tidy_model_strength,
combined_strength_plot
)
tidy_model_function
targets::tar_visnetwork()
targets::tar_load(
c(
model_function,
tidy_model_function,
combined_function_plot,
model_strength,
tidy_model_strength,
combined_strength_plot
)
)
n_conditions_function <- model_function$data |> group_by(study_code, training_control) |> slice_head() |> ungroup() |> count(training_control)
n_conditions_strength <- model_strength$data |> group_by(study_code, training_control) |> slice_head() |> ungroup() |> count(training_control)
targets::tar_visnetwork()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
tidy_model_function <- tidy_model_function |>
mutate_if(is.numeric(), round(2))
tidy_model_function <- tidy_model_function |>
mutate_if(is.numeric, round(2))
tidy_model_function <- tidy_model_function |>
mutate_if(is.numeric, round(.,2))
tidy_model_function <- tidy_model_function |>
mutate_if(where(is.numeric), round(.,2))
tidy_model_function <- tidy_model_function |>
mutate_if(where(is.numeric), round(2))
tidy_model_function
tidy_model_function <- tidy_model_function |>
across(where(is.numeric), round(2))
tidy_model_function <- tidy_model_function |>
mutate(across(where(is.numeric), round(2)))
mutate(across(where(is.numeric), round, 2)
tidy_model_function <- tidy_model_function |>
tidy_model_function <- tidy_model_function |>
mutate(across(where(is.numeric), round, 2))
tidy_model_function
period <- 4  ## that is freq is 1/4
time <- seq(0, 10, by = 0.1)
sine_wave <- sin(2 * pi * time / period)
sine_wave
## Apply fft function
fft_result <- fft(sine_wave)
# Visualization
par(mfrow = c(2, 1))
plot(time, sine_wave, type = "l", main = "Original Sine Wave")
plot(Mod(fft_result), type = "l", main = "FFT Magnitudes")
period <- 8  ## that is freq is 1/4
time <- seq(0, 10, by = 0.1)
sine_wave <- sin(2 * pi * time / period)
## Apply fft function
fft_result <- fft(sine_wave)
# Visualization
par(mfrow = c(2, 1))
plot(time, sine_wave, type = "l", main = "Original Sine Wave")
plot(Mod(fft_result), type = "l", main = "FFT Magnitudes")
period <- 2  ## that is freq is 1/4
time <- seq(0, 10, by = 0.1)
sine_wave <- sin(2 * pi * time / period)
## Apply fft function
fft_result <- fft(sine_wave)
# Visualization
par(mfrow = c(2, 1))
plot(time, sine_wave, type = "l", main = "Original Sine Wave")
plot(Mod(fft_result), type = "l", main = "FFT Magnitudes")
fft_result
?fft
fft_result |>
slice_head(n = 3)
library(dplyr)
fft_result |>
slice_head(n = 3)
Mod(fft_result) |>
slice_head(n = 3)
Mod(fft_result)
fft_result[1]
fft_result[2]
fft_result[3]
Mod(fft_result)[3]
Mod(fft_result)[1]
Mod(fft_result)[1:3]
time <- seq(0, 10, by = 1)
sine_wave <- sin(2 * pi * time / period)
## Apply fft function
fft_result <- fft(sine_wave)
# Visualization
par(mfrow = c(2, 1))
plot(time, sine_wave, type = "l", main = "Original Sine Wave")
plot(Mod(fft_result), type = "l", main = "FFT Magnitudes")
time <- seq(0, 10, by = 0.05)
sine_wave <- sin(2 * pi * time / period)
## Apply fft function
fft_result <- fft(sine_wave)
# Visualization
par(mfrow = c(2, 1))
plot(time, sine_wave, type = "l", main = "Original Sine Wave")
plot(Mod(fft_result), type = "l", main = "FFT Magnitudes")
0.05*5
0.05*50
Mod(fft_result)[1:50]
max(Mod(fft_result)[1:50])
max(Mod(fft_result)[1:50])/60
magnitudes<- abs(fft_result)  ## or mod()
magnitudes<- abs(fft_result)[10:50]  ## or mod()
# Find the frequency with the largest amplitude
max_index_sine <- which.max(magnitudes)
paste("magnitude value: ", magnitudes[max_index_sine] )
magnitudes[max_index_sine]
magnitudes[max_index_sine]*60
which.max(magnitudes)
max_index_sine
magnitudes
period <- 1  ## that is freq is 1/4
time <- seq(0, 10, by = 0.05)
sine_wave <- sin(2 * pi * time / period)
## Apply fft function
fft_result <- fft(sine_wave)
# Visualization
par(mfrow = c(2, 1))
plot(time, sine_wave, type = "l", main = "Original Sine Wave")
plot(Mod(fft_result), type = "l", main = "FFT Magnitudes")
# Find the frequency with the largest amplitude
max_index_sine <- which.max(magnitudes)
paste("magnitude value: ", magnitudes[max_index_sine] )
magnitudes[max_index_sine]*60
# Find the frequency with the largest amplitude
magnitudes<- abs(fft_result)  ## or mod()
max_index_sine <- which.max(magnitudes)
paste("magnitude value: ", magnitudes[max_index_sine] )
magnitudes[max_index_sine]*60
period <- 1.5  ## that is freq is 1/4
time <- seq(0, 10, by = 0.05)
sine_wave <- sin(2 * pi * time / period)
## Apply fft function
fft_result <- fft(sine_wave)
# Visualization
par(mfrow = c(2, 1))
plot(time, sine_wave, type = "l", main = "Original Sine Wave")
plot(Mod(fft_result), type = "l", main = "FFT Magnitudes")
# Find the frequency with the largest amplitude
magnitudes<- abs(fft_result)  ## or mod()
max_index_sine <- which.max(magnitudes)
paste("magnitude value: ", magnitudes[max_index_sine] )
magnitudes[max_index_sine]*60
